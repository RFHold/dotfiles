#! /bin/sh

# Check and install Xcode Command Line Tools
if ! xcode-select -p &> /dev/null; then
    xcode-select --install
fi

# Check and install Homebrew
if ! command -v brew &> /dev/null; then
    /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
    echo 'eval "$(/opt/homebrew/bin/brew shellenv)"' >> ~/.zprofile
    eval "$(/opt/homebrew/bin/brew shellenv)"
fi

# Check and install Ansible
if ! command -v ansible &> /dev/null; then
    brew install ansible
fi

# Clone dotfiles repository
if [ ! -d ~/dotfiles ]; then
		git clone --recursive git@github.com:RFHold/dotfiles.git $HOME/dotfiles
fi

# Run Ansible playbook
ansible-playbook $HOME/dotfiles/playbooks/setup-dev-machine.yaml

